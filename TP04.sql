--FAY Damien INF-S2 TP5B

--R30

--a UNION

SELECT  nom||' '||prnm AS Client,
        prfs AS Profession
FROM    LOCVEC.CLIENT
WHERE   prfs =    (SELECT   prfs
                   FROM     LOCVEC.CLIENT
                   WHERE    UPPER(nom||' '||prnm) = 'LECOMTE MARCELLE')
UNION
SELECT  nom||' '||prnm AS Client,
        prfs AS Profession
FROM    LOCVEC.CLIENT
WHERE   prfs is null
ORDER   BY nom;

--b NVL

SELECT  C.nom||' '||C.prnm AS Client,
        C.prfs AS Profession
FROM    LOCVEC.CLIENT C
        INNER JOIN LOCVEC.CLIENT C2 ON (C.cdcli = C2.cdcli)
WHERE   UPPER(C2.nom||' '||C2.prnm) = 'LECOMTE MARCELLE'
        OR C.prfs is null
ORDER   BY C.nom;
                   
--R31

SELECT  nom||'-'||prnm AS Personne,
        datns AS "Date de naissance",
        prfs AS profession,
        NVL('CLIENT', 'EMPLOYE') AS Statut
FROM    LOCVEC.CLIENT
WHERE   TO_CHAR(datns, 'YYYY') < 1960
UNION
SELECT  nom||'-'||prnm AS Persone,
        datns AS "Date de naissance",
        qualif AS profession,
        NVL('EMPLOYE', 'CLIENT') AS Statut
FROM    LOCVEC.EMPLOYE
WHERE   TO_CHAR(datns, 'YYYY') < 1960
ORDER   BY profession, "Date de naissance";
                   
--R32

SELECT  MO.marque||' '||MO.tpmdl AS Modèle,
        CTG.intctg AS Catégorie
FROM    LOCVEC.MODELE MO
        INNER JOIN LOCVEC.CATEGORIE CTG ON (MO.cdctg = CTG.cdctg)
        --INNER JOIN LOCVEC.VEHICULE VE ON (MO.cdmdl = VE.cdmdl)
MINUS
SELECT  MO.marque||' '||MO.tpmdl AS Modèle,
        CTG.intctg AS Catégorie
FROM    LOCVEC.MODELE MO
        INNER JOIN LOCVEC.CATEGORIE CTG ON (MO.cdctg = CTG.cdctg)
        INNER JOIN LOCVEC.VEHICULE VE ON (MO.cdmdl = VE.cdmdl);
                   
--R33

--a JOINTURE
                   
SELECT  E.nom||' '||E.prnm AS Employé
FROM    LOCVEC.EMPLOYE E
        LEFT JOIN LOCVEC.CONTRAT CT ON (E.cdemp = CT.cdemp)
WHERE   CT.CDCTR is null
        AND E.qualif = 'COMMERCIAL';
                   
--b SOUS-REQUÊTE

SELECT  nom||' '||prnm AS Employé
FROM    LOCVEC.EMPLOYE
WHERE   qualif = 'COMMERCIAL'
        AND cdemp NOT IN (SELECT  cdemp
                            FROM    LOCVEC.CONTRAT);

--c OPÉRATEUR D'ENSEMBLE

SELECT  NVL2(cdemp, nom||' '||prnm, cdemp) AS Employé
FROM    LOCVEC.EMPLOYE
WHERE   qualif = 'COMMERCIAL'
MINUS
SELECT  cdemp
FROM    LOCVEC.CONTRAT;

--R34

SELECT  TPCTR.inttpctr AS "Type Contrat",
        NVL2(TF.tarif_base, 'Tarif Base', NVL2(TF.tarif_km, 'Tarif Km', 'Tarif Options')) AS "Type de tarif",
        NVL(TF.tarif_base, NVL(TF.tarif_km, (TF.tarif_ca + TF.tarif_arf + TF.tarif_Atm))) AS Tarif
FROM    LOCVEC.TARIF TF
        INNER JOIN LOCVEC.TYPECONTRAT TPCTR ON (TF.cdtpctr = TPCTR.cdtpctr)
        INNER JOIN LOCVEC.CATEGORIE CTG ON (TF.cdctg = CTG.cdctg)
WHERE   UPPER(CTG.cdctg) = 'A';

SELECT  cdctg
FROM    LOCVEC.CATEGORIE;
        


