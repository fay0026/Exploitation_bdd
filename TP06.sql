DROP TABLE COMPETITION CASCADE CONSTRAINTS;

--Exercice 2 : Création de table

--a

CREATE TABLE COMPETITION
(
    CDCOMPET        CHAR(5),
    LIBCOMPET       VARCHAR2(50)    not null,
    DATECOMPET      DATE DEFAULT SYSDATE,
    PARCOURS        NUMBER
        constraint CKC_PARCOURS check (parcours in ('1','2')),
    INDMAX          NUMBER
        constraint CKC_INDMAX check (indmax between 0 and 36),
    DROITSINSC      NUMBER(8,2),
    CONSTRAINT PK_COMPETITION PRIMARY KEY (CDCOMPET)
);

--b

INSERT INTO COMPETITION
VALUES ('TE01', 'Compet 1', TO_DATE('03/04/2019', 'DD/MM/YYYY'), 1, 13, 17);
        
INSERT INTO COMPETITION
VALUES ('TE02', 'Compet 2', TO_DATE('05/04/2019', 'DD/MM/YYYY'), 2, 15, 18);
        
INSERT INTO COMPETITION
VALUES ('TE03', 'Compet 3', TO_DATE('10/04/2019', 'DD/MM/YYYY'), 2, 24, 25);
        
INSERT INTO COMPETITION
VALUES ('TE04', 'Compet 4', Null, 2, 25, 25);
        
INSERT INTO COMPETITION
VALUES ('TE05', 'Compet 5', TO_DATE('16/04/2019', 'DD/MM/YYYY'), 1, 45, 14);

--Changement de la dernière insertion, car il y a une restriction de 0 à 36,
--et la valeur étant 45, cela provoque une erreur.
--La date affectée à la 4ème insertion est la (null), la valeur de base n'a
--donc pas été utilisée

INSERT INTO COMPETITION (cdcompet, libcompet, parcours, indmax, droitsinsc)
VALUES ('TE05', 'Compet 5', 1, 13, 17);

--c

INSERT INTO COMPETITION
SELECT * FROM MINIGOLF.COMPETITION;

--d

DELETE FROM COMPETITION
WHERE CDCOMPET LIKE 'TE%';

--e

UPDATE COMPETITION
SET droitsInsc = droitsInsc * 1.1
WHERE parcours = 2;

--Exercice 3

--a

INSERT INTO MONITEUR
VALUES ('M2', 'TORDUE', 'Paul', '20, Rue Nationale', 'LA NEUVILETTE', 51100, 'M1', 1, 3);

--La contrainte d'intégrité référentielle n'est pas respectée, car le moniteur M1 n'a pas
--encore été créé.

--b

ALTER TABLE MONITEUR 
    ADD CONSTRAINT fk_type FOREIGN KEY(responsable) 
                                REFERENCES MONITEUR(cdmono) ON DELETE CASCADE;

--c

INSERT INTO MONITEUR
VALUES ('M1', 'DUMAS', 'Arnaud', '14, Bd Gambetta', 'REIMS', 51100, '', 2, 1);

INSERT INTO MONITEUR
VALUES ('M2', 'TORDUE', 'Paul', '20, Rue Nationale', 'LA NEUVILETTE', 51100, 'M1', 1, 3);

--d

INSERT INTO MEMBRE (cdmemb, nom, prnm, adr, ville, cp, tpmemb, nbcoursuivis, ind)
SELECT cdpers, nom, prnm, adr, ville, cp, tpmemb, nbcoursuivis, ind FROM MINIGOLF.PERSONNE WHERE tpmemb != 3;

--SELECT * ne peut pas marcher à cause d'une valeur supplémentaire située dans
--la table personne, il faut donc individuellement choisir les champs.

--e

UPDATE MEMBRE
SET nom = UPPER(nom);



























































